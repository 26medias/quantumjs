<!DOCTYPE HTML>
<html lang="en-US">
<head>
	<title>QuantumJS</title>
	<meta charset="UTF-8">
	<script type="text/javascript" src="jquery.min.js"></script>
	<script type="text/javascript" src="json2.js"></script>
	<script type="text/javascript" src="Arbiter.js"></script>
	<script type="text/javascript" src="quantum.js"></script>
	<script type="text/javascript" src="quantumArray.js"></script>
	<script type="text/javascript" src="quantumObject.js"></script>
	<script type="text/javascript" src="quantumString.js"></script>
	<style type="text/css">
		ul {
			padding:0;
			margin:0;
			padding-left: 20px;
		}
	</style>
</head>
<body data-scope="taskmanager">
	<table border="1">
		<thead>
			<tr>
				<th>State</th>
				<th>Title</th>
				<th>Name</th>
				<th>List</th>
				<th>Tel</th>
			</tr>
		</thead>
		<tbody data-foreach="tasks">
			<tr data-bind="{'attr':{'data-id':'name'}}">
				<td>
					<span data-bind="{'html':{'isCompleted':['completed']}}"></span>
				</td>
				<td>
					<span data-bind="{'html':'title'}"></span>
				</td>
				<td>
					<span data-bind="{'html':'name'}"></span>
				</td>
				<td>
					<ul data-foreach="list">
						<li>
							<span data-bind="{'html':'user'}"></span>
							<ul data-foreach="img">
								<li><img data-bind="{'attr':{'src':'url'}}" style="width: 60px;" src="" alt="" /></li>
							</ul>
						</li>
					</ul>
				</td>
				<td>
					<ul data-foreach="tel">
						<li>
							<span data-bind="{'html':'num'}"></span>
						</li>
					</ul>
				</td>
			</tr>
		</tbody>
	</table>
	<a href="javascript:void(0);" data-event="{'click':'create'}">create</a>
	<a href="javascript:void(0);" data-event="{'click':'update'}">update</a>
	
	<script type="text/javascript">
		console.debug = function(label, data) {
			console.group(label);
			if (data instanceof Array) {
				console.dir(data);
			} else {
				for (var i in data) {
					console.log(i,data[i]);
				}
			}
			console.groupEnd();
		};

		var tasks = [
			{
				id:			1,
				title:		"task #1",
				name:		"name #1",
				completed:	"yes",
				list:	[
					{user:"Bill", img:[{url:"images/George Takei's head.png"},{url:"images/Lucy Liu's Head.png"}]},
					{user:"Erik", img:[{url:"images/Al Gores Head.png"},{url:"images/Richard Nixon's Head.png"}]},
					{user:"Sookie", img:[{url:"images/Pamela Anderson.png"}]}
				],
				tel:	[
					{num:"123445"},
					{num:"azerty"},
					{num:"7896"}
				]
			},
			{
				id:			2,
				title:		"task #2",
				name:		"name #2",
				completed:	"no",
				list:	[
					{user:"Jason", img:[{url:"images/David Cohens Head.png"},{url:"images/David Duchovnys Head.png"}]},
					{user:"Hoit", img:[]}
				],
				tel:	[
					{num:"azertyfgdfdf"},
					{num:"0801653521"},
				]
			},
			{
				id:			3,
				title:		"task #3",
				name:		"name #3",
				completed:	"yes",
				list:	[
					{user:"Bender", img:[]},
					{user:"Fry", img:[{url:"images/George Takei's head.png"},{url:"images/Lucy Liu's Head.png"}]},
					{user:"Leela", img:[]}
				],
				tel:	[
					{num:"7896fdfds"}
				]
			}
		];
		
		var taskController = function(quantumjs) {
			this.quantumjs 	= quantumjs;
			this.counter 	= 3;
			this.tasks 		= new quantumArray(["tasks"], this)
		}
		taskController.prototype.init = function() {
			this.tasks.load(tasks);
			console.log("tasks", this.tasks);
		};
		
		taskController.prototype.create = function() {
			console.log(this.tasks);
			this.counter++;
			var task = {
				id:			this.counter,
				title:		"task #"+this.counter,
				name:		"name #"+this.counter,
				completed:	"yes",
				list:	[
					{user:"Elzar"},
					{user:"Zoidberg"}
				],
				tel:	[
					{num:"7896fdfds"}
				]
			};
			this.tasks.push(task);
		}
		taskController.prototype.update = function() {
			console.log("tasks",this.tasks);
			this.tasks.data[5].data["name"].val("YEAH!");
		}
		
		taskController.prototype.isCompleted = function(state) {
			
			return "["+state+"]";
		}
		
		$(function() {
			var quantumInterface = new quantumjs(taskController, "taskmanager");
			//quantumInterface.loadQuantumArray('tasks', tasks);
			
		});
		
	</script>
</body>
</html>
