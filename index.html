<!DOCTYPE HTML>
<html lang="en-US">
<head>
	<title>QuantumJS</title>
	<meta charset="UTF-8">
	<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.1/jquery.min.js"></script>
	<script type="text/javascript" src="json2.js"></script>
	<script type="text/javascript" src="Arbiter.js"></script>
	<script type="text/javascript" src="quantum.js"></script>
	<script type="text/javascript" src="quantumArray.js"></script>
	<script type="text/javascript" src="quantumObject.js"></script>
	<script type="text/javascript" src="quantumString.js"></script>
	<style type="text/css">
		ul {
			padding:0;
			margin:0;
			padding-left: 20px;
		}
	</style>
</head>
<body data-scope="taskmanager">
	<table border="1">
		<thead>
			<tr>
				<th>State</th>
				<th>Title</th>
				<th>Name</th>
				<th>List</th>
			</tr>
		</thead>
		<tbody data-foreach="tasks">
			<tr>
				<td>
					<span data-bind="{'html':{'isCompleted':['completed']}}"></span>
				</td>
				<td>
					<span data-bind="{'html':'title'}"></span>
				</td>
				<td>
					<span data-bind="{'html':'name'}"></span>
				</td>
				<td>
					<ul data-foreach="list">
						<li data-bind="{'html':'user'}"></li>
					</ul>
				</td>
			</tr>
		</tbody>
	</table>
	<a href="javascript:void(0);" data-event="{'click':'create'}">create</a>
	<a href="javascript:void(0);" data-event="{'click':'update'}">update</a>
	
	<script type="text/javascript">
		var tasks = [
			{
				id:			1,
				title:		"task #1",
				name:		"name #1",
				completed:	"yes",
				list:	[
					{user:"Bill"},
					{user:"Erik"},
					{user:"Sookie"}
				]
			},
			{
				id:			2,
				title:		"task #2",
				name:		"name #2",
				completed:	"no",
				list:	[
					{user:"Jason"},
					{user:"Hoit"}
				]
			},
			{
				id:			3,
				title:		"task #3",
				name:		"name #3",
				completed:	"yes",
				list:	[
					{user:"Bender"},
					{user:"Fry"},
					{user:"Leela"}
				]
			}
		];
		
		var taskController = function() {
			this.counter 	= 3;
			this.tasks 		= new quantumArray();
		}
		taskController.prototype.create = function() {
			console.log(this.tasks);
			this.counter++;
			var task = {
				id:			this.counter,
				title:		"task #"+this.counter,
				name:		"name #"+this.counter,
				completed:	"yes",
				list:	[
					{user:"Elzar"},
					{user:"Zoidberg"}
				]
			};
			this.tasks.push(task);
		}
		taskController.prototype.update = function() {
			console.debug("tasks",this.tasks);
			this.tasks.data[5].data["name"].val("YEAH!");
		}
		
		taskController.prototype.isCompleted = function(state) {
			
			return "["+state+"]";
		}
		
		$(function() {
			var quantumInterface = new quantumjs(taskController, "taskmanager");
			quantumInterface.monitor();
			quantumInterface.loadQuantumArray('tasks', tasks);
		});
		
	</script>
</body>
</html>
